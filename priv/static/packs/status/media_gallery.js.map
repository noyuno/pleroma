{"version":3,"sources":["webpack:///status/media_gallery.js","webpack:///./app/javascript/mastodon/components/media_gallery.js"],"names":["webpackJsonp","155","module","__webpack_exports__","__webpack_require__","Object","defineProperty","value","d","MediaGallery","_class","_temp2","_class2","__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_jsx__","__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_jsx___default","n","__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_classCallCheck__","__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_classCallCheck___default","__WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_possibleConstructorReturn__","__WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_possibleConstructorReturn___default","__WEBPACK_IMPORTED_MODULE_3_babel_runtime_helpers_inherits__","__WEBPACK_IMPORTED_MODULE_3_babel_runtime_helpers_inherits___default","__WEBPACK_IMPORTED_MODULE_4_react__","__WEBPACK_IMPORTED_MODULE_4_react___default","__WEBPACK_IMPORTED_MODULE_5_prop_types__","__WEBPACK_IMPORTED_MODULE_5_prop_types___default","__WEBPACK_IMPORTED_MODULE_6_immutable__","__WEBPACK_IMPORTED_MODULE_7_react_intl__","__WEBPACK_IMPORTED_MODULE_8__is_mobile__","__WEBPACK_IMPORTED_MODULE_9__initial_state__","messages","hidden","id","defaultMessage","sensitive","toggle","toggle_visible","warning","Item","_React$PureComponent","_temp","_this","_ret","this","_len","arguments","length","args","Array","_key","call","apply","concat","handleMouseEnter","e","hoverToPlay","target","play","handleMouseLeave","pause","currentTime","handleClick","_this$props","props","index","onClick","context","router","button","preventDefault","stopPropagation","prototype","attachment","get","render","thumbnail","focusX","getIn","focusY","x","y","className","href","src","alt","title","style","objectPosition","aria-label","role","loop","controls","autoPlay","onMouseEnter","onMouseLeave","muted","a","PureComponent","contextTypes","object","defaultProps","_React$PureComponent2","_temp3","_this2","_ret2","_len2","_key2","state","visible","handleOpen","setState","onOpenMedia","media","componentWillReceiveProps","nextProps","_props","intl","render_sensitiveInfo","formatMessage","createElement","render_mediaSpoiler","render_attachement","lenght","map","i"],"mappings":"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","file":"status/media_gallery.js","sourcesContent":["webpackJsonp([26],{\n\n/***/ 155:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return MediaGallery; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_jsx__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_jsx___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_jsx__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_classCallCheck__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_classCallCheck___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_classCallCheck__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_possibleConstructorReturn__ = __webpack_require__(3);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_possibleConstructorReturn___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_possibleConstructorReturn__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_helpers_inherits__ = __webpack_require__(4);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_babel_runtime_helpers_inherits___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_helpers_inherits__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_react__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4_react___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_4_react__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_prop_types__ = __webpack_require__(5);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5_prop_types___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5_prop_types__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_immutable__ = __webpack_require__(8);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6_immutable___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_6_immutable__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7_react_intl__ = __webpack_require__(6);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__is_mobile__ = __webpack_require__(35);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__initial_state__ = __webpack_require__(12);\n\n\n\n\n\nvar _class, _temp2, _class2;\n\n\n\n\n\n\n\n\n\nvar messages = Object(__WEBPACK_IMPORTED_MODULE_7_react_intl__[\"f\" /* defineMessages */])({\n  hidden: {\n    'id': 'status.media_hidden',\n    'defaultMessage': 'Media hidden'\n  },\n  sensitive: {\n    'id': 'media_gallery.sensitive',\n    'defaultMessage': 'Sensitive'\n  },\n  toggle: {\n    'id': 'status.sensitive_toggle',\n    'defaultMessage': 'Click to view'\n  },\n  toggle_visible: {\n    'id': 'media_gallery.toggle_visible',\n    'defaultMessage': 'Toggle visibility'\n  },\n  warning: {\n    'id': 'status.sensitive_warning',\n    'defaultMessage': 'Sensitive content'\n  }\n});\n\nvar Item = (_temp2 = _class = function (_React$PureComponent) {\n  __WEBPACK_IMPORTED_MODULE_3_babel_runtime_helpers_inherits___default()(Item, _React$PureComponent);\n\n  function Item() {\n    var _temp, _this, _ret;\n\n    __WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_classCallCheck___default()(this, Item);\n\n    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    return _ret = (_temp = (_this = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_possibleConstructorReturn___default()(this, _React$PureComponent.call.apply(_React$PureComponent, [this].concat(args))), _this), _this.handleMouseEnter = function (e) {\n      if (_this.hoverToPlay()) {\n        e.target.play();\n      }\n    }, _this.handleMouseLeave = function (e) {\n      if (_this.hoverToPlay()) {\n        e.target.pause();\n        e.target.currentTime = 0;\n      }\n    }, _this.handleClick = function (e) {\n      var _this$props = _this.props,\n          index = _this$props.index,\n          onClick = _this$props.onClick;\n\n\n      if (_this.context.router && e.button === 0) {\n        e.preventDefault();\n        onClick(index);\n      }\n\n      e.stopPropagation();\n    }, _temp), __WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_possibleConstructorReturn___default()(_this, _ret);\n  }\n\n  Item.prototype.hoverToPlay = function hoverToPlay() {\n    var attachment = this.props.attachment;\n\n    return !__WEBPACK_IMPORTED_MODULE_9__initial_state__[\"a\" /* autoPlayGif */] && attachment.get('type') === 'gifv';\n  };\n\n  Item.prototype.render = function render() {\n    var attachment = this.props.attachment;\n\n\n    var thumbnail = '';\n\n    if (attachment.get('type') === 'image') {\n      var focusX = attachment.getIn(['meta', 'focus', 'x']) || 0;\n      var focusY = attachment.getIn(['meta', 'focus', 'y']) || 0;\n      var x = (focusX / 2 + .5) * 100;\n      var y = (focusY / -2 + .5) * 100;\n\n      thumbnail = __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_jsx___default()('a', {\n        className: 'attachement',\n        href: attachment.get('remote_url') || attachment.get('url'),\n        onClick: this.handleClick,\n        target: '_blank'\n      }, void 0, __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_jsx___default()('img', {\n        src: attachment.get('url'),\n        alt: attachment.get('description'),\n        title: attachment.get('description'),\n        style: { objectPosition: x + '% ' + y + '%' }\n      }));\n    } else if (attachment.get('type') === 'audio') {\n      thumbnail = __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_jsx___default()('audio', {\n        className: 'attachement',\n        'aria-label': attachment.get('description'),\n        role: 'application',\n        src: attachment.get('url'),\n        loop: true,\n        controls: true\n      });\n    } else if (attachment.get('type') === 'gifv') {\n      var autoPlay = !Object(__WEBPACK_IMPORTED_MODULE_8__is_mobile__[\"a\" /* isIOS */])() && __WEBPACK_IMPORTED_MODULE_9__initial_state__[\"a\" /* autoPlayGif */];\n\n      thumbnail = __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_jsx___default()('video', {\n        className: 'attachement',\n        'aria-label': attachment.get('description'),\n        role: 'application',\n        src: attachment.get('url'),\n        onClick: this.handleClick,\n        onMouseEnter: this.handleMouseEnter,\n        onMouseLeave: this.handleMouseLeave,\n        autoPlay: autoPlay,\n        loop: true,\n        muted: true\n      });\n    }\n    return thumbnail;\n  };\n\n  return Item;\n}(__WEBPACK_IMPORTED_MODULE_4_react___default.a.PureComponent), _class.contextTypes = {\n  router: __WEBPACK_IMPORTED_MODULE_5_prop_types___default.a.object\n}, _class.defaultProps = {\n  index: 0\n}, _temp2);\n\nvar MediaGallery = Object(__WEBPACK_IMPORTED_MODULE_7_react_intl__[\"g\" /* injectIntl */])(_class2 = function (_React$PureComponent2) {\n  __WEBPACK_IMPORTED_MODULE_3_babel_runtime_helpers_inherits___default()(MediaGallery, _React$PureComponent2);\n\n  function MediaGallery() {\n    var _temp3, _this2, _ret2;\n\n    __WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_classCallCheck___default()(this, MediaGallery);\n\n    for (var _len2 = arguments.length, args = Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n      args[_key2] = arguments[_key2];\n    }\n\n    return _ret2 = (_temp3 = (_this2 = __WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_possibleConstructorReturn___default()(this, _React$PureComponent2.call.apply(_React$PureComponent2, [this].concat(args))), _this2), _this2.state = {\n      visible: !_this2.props.sensitive || __WEBPACK_IMPORTED_MODULE_9__initial_state__[\"f\" /* displaySensitiveMedia */]\n    }, _this2.handleOpen = function () {\n      _this2.setState({ visible: !_this2.state.visible });\n    }, _this2.handleClick = function (index) {\n      _this2.props.onOpenMedia(_this2.props.media, index);\n    }, _temp3), __WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_possibleConstructorReturn___default()(_this2, _ret2);\n  }\n\n  MediaGallery.prototype.componentWillReceiveProps = function componentWillReceiveProps(nextProps) {\n    if (!Object(__WEBPACK_IMPORTED_MODULE_6_immutable__[\"is\"])(nextProps.media, this.props.media)) {\n      this.setState({ visible: !nextProps.sensitive });\n    }\n  };\n\n  MediaGallery.prototype.render = function render() {\n    var handleClick = this.handleClick,\n        handleOpen = this.handleOpen;\n    var _props = this.props,\n        intl = _props.intl,\n        media = _props.media,\n        sensitive = _props.sensitive;\n    var visible = this.state.visible;\n\n\n    var render_sensitiveInfo = __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_jsx___default()('button', {\n      className: 'icon-button overlayed sensitive-info',\n      onClick: handleOpen,\n      title: intl.formatMessage(messages.toggle_visible)\n    }, void 0, '\\uD83D\\uDC41', sensitive ? __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_jsx___default()('span', {\n      className: 'sensitive-marker'\n    }, void 0, __WEBPACK_IMPORTED_MODULE_4_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_7_react_intl__[\"b\" /* FormattedMessage */], messages.sensitive)) : null);\n\n    var render_mediaSpoiler = __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_jsx___default()('button', {\n      className: 'media-spoiler',\n      onClick: handleOpen\n    }, void 0, __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_jsx___default()('span', {\n      className: 'media-spoiler__warning'\n    }, void 0, __WEBPACK_IMPORTED_MODULE_4_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_7_react_intl__[\"b\" /* FormattedMessage */], sensitive ? messages.warning : messages.hidden)), __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_jsx___default()('span', {\n      className: 'media-spoiler__trigger'\n    }, void 0, __WEBPACK_IMPORTED_MODULE_4_react___default.a.createElement(__WEBPACK_IMPORTED_MODULE_7_react_intl__[\"b\" /* FormattedMessage */], messages.toggle)));\n\n    var render_attachement = 'media_error';\n\n    switch (media.lenght) {\n      case 0:\n        break;\n      case 1:\n        render_attachement = __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_jsx___default()(Item, {\n          attachment: media.get(0),\n          onClick: handleClick\n        });\n        break;\n      default:\n        render_attachement = media.map(function (attachment, i) {\n          return __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_jsx___default()(Item, {\n            attachment: attachment,\n            index: i,\n            onClick: handleClick\n          }, attachment.get('id'));\n        });\n\n    };\n\n    if (visible) {\n      return __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_jsx___default()('div', {\n        className: 'media-gallery'\n      }, void 0, render_sensitiveInfo, ' ', render_attachement);\n    } else {\n      return __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_jsx___default()('div', {\n        className: 'media-gallery'\n      }, void 0, render_mediaSpoiler);\n    }\n  };\n\n  return MediaGallery;\n}(__WEBPACK_IMPORTED_MODULE_4_react___default.a.PureComponent)) || _class2;\n\n\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// status/media_gallery.js","import React from 'react';\nimport ImmutablePropTypes from 'react-immutable-proptypes';\nimport PropTypes from 'prop-types';\nimport { is } from 'immutable';\nimport { defineMessages, injectIntl, FormattedMessage } from 'react-intl';\nimport { isIOS } from '../is_mobile';\nimport { autoPlayGif, displaySensitiveMedia } from '../initial_state';\n\nconst messages = defineMessages({\n  hidden: {\n    defaultMessage: 'Media hidden',\n    id: 'status.media_hidden',\n  },\n  sensitive: {\n    defaultMessage: 'Sensitive',\n    id: 'media_gallery.sensitive',\n  },\n  toggle: {\n    defaultMessage: 'Click to view',\n    id: 'status.sensitive_toggle',\n  },\n  toggle_visible: {\n    defaultMessage: 'Toggle visibility',\n    id: 'media_gallery.toggle_visible',\n  },\n  warning: {\n    defaultMessage: 'Sensitive content',\n    id: 'status.sensitive_warning',\n  },\n});\n\nclass Item extends React.PureComponent {\n\n  static contextTypes = {\n    router: PropTypes.object,\n  };\n\n  static propTypes = {\n    attachment: ImmutablePropTypes.map.isRequired,\n    index: PropTypes.number.isRequired,\n    onClick: PropTypes.func.isRequired,\n  };\n\n  static defaultProps = {\n    index: 0,\n  };\n\n  handleMouseEnter = (e) => {\n    if (this.hoverToPlay()) {\n      e.target.play();\n    }\n  }\n\n  handleMouseLeave = (e) => {\n    if (this.hoverToPlay()) {\n      e.target.pause();\n      e.target.currentTime = 0;\n    }\n  }\n\n  hoverToPlay () {\n    const { attachment } = this.props;\n    return !autoPlayGif && attachment.get('type') === 'gifv';\n  }\n\n  handleClick = (e) => {\n    const { index, onClick } = this.props;\n\n    if (this.context.router && e.button === 0) {\n      e.preventDefault();\n      onClick(index);\n    }\n\n    e.stopPropagation();\n  }\n\n  render () {\n    const { attachment } = this.props;\n\n    let thumbnail = '';\n\n    if (attachment.get('type') === 'image') {\n      const focusX = attachment.getIn(['meta', 'focus', 'x']) || 0;\n      const focusY = attachment.getIn(['meta', 'focus', 'y']) || 0;\n      const x      = ((focusX /  2) + .5) * 100;\n      const y      = ((focusY / -2) + .5) * 100;\n\n      thumbnail = (\n        <a\n          className=\"attachement\"\n          href={attachment.get('remote_url') || attachment.get('url')}\n          onClick={this.handleClick}\n          target='_blank'\n        >\n          <img\n            src={attachment.get('url')}\n            alt={attachment.get('description')}\n            title={attachment.get('description')}\n            style={{ objectPosition: `${x}% ${y}%` }}\n          />\n        </a>\n      );\n    } else if (attachment.get('type') === 'audio') {\n      thumbnail = (\n        <audio\n          className=\"attachement\"\n          aria-label={attachment.get('description')}\n          role='application'\n          src={attachment.get('url')}\n          loop\n          controls\n        />\n      );\n    } else if (attachment.get('type') === 'gifv') {\n      const autoPlay = !isIOS() && autoPlayGif;\n\n      thumbnail = (\n        <video\n          className=\"attachement\"\n          aria-label={attachment.get('description')}\n          role='application'\n          src={attachment.get('url')}\n          onClick={this.handleClick}\n          onMouseEnter={this.handleMouseEnter}\n          onMouseLeave={this.handleMouseLeave}\n          autoPlay={autoPlay}\n          loop\n          muted\n        />\n      );\n    }\n    return thumbnail;\n  }\n\n}\n\n@injectIntl\nexport default class MediaGallery extends React.PureComponent {\n\n  static propTypes = {\n    sensitive: PropTypes.bool,\n    media: ImmutablePropTypes.list.isRequired,\n    onOpenMedia: PropTypes.func.isRequired,\n    intl: PropTypes.object.isRequired,\n  };\n\n  state = {\n    visible: !this.props.sensitive || displaySensitiveMedia,\n  };\n\n  componentWillReceiveProps (nextProps) {\n    if (!is(nextProps.media, this.props.media)) {\n      this.setState({ visible: !nextProps.sensitive });\n    }\n  }\n\n  handleOpen = () => {\n    this.setState({ visible: !this.state.visible });\n  }\n\n  handleClick = (index) => {\n    this.props.onOpenMedia(this.props.media, index);\n  }\n\n  render () {\n    const {\n      handleClick,\n      handleOpen,\n    } = this;\n    const {\n      intl,\n      media,\n      sensitive,\n    } = this.props;\n    const { visible } = this.state;\n\n    let render_sensitiveInfo = (\n      <button\n        className=\"icon-button overlayed sensitive-info\"\n        onClick={handleOpen}\n        title={intl.formatMessage(messages.toggle_visible)}\n      >\n        👁\n        {sensitive ? (\n          <span className='sensitive-marker'>\n            <FormattedMessage {...messages.sensitive} />\n          </span>\n        ) : null}\n      </button>\n    );\n\n    let render_mediaSpoiler = (\n      <button\n        className='media-spoiler'\n        onClick={handleOpen}\n      >\n        <span className='media-spoiler__warning'>\n          <FormattedMessage {...(sensitive ? messages.warning : messages.hidden)} />\n        </span>\n        <span className='media-spoiler__trigger'>\n          <FormattedMessage {...messages.toggle} />\n        </span>\n      </button>\n    );\n\n    let render_attachement = ( 'media_error' );\n\n    switch (media.lenght) {\n    case 0: break;\n    case 1: render_attachement = (\n      <Item\n        attachment={media.get(0)}\n        onClick={handleClick}\n      />\n    );\n      break;\n    default: render_attachement = (\n      media.map(\n        (attachment, i) => (\n          <Item\n            attachment={attachment}\n            index={i}\n            key={attachment.get('id')}\n            onClick={handleClick}\n          />\n        )\n      )\n    );\n\n    };\n\n    if (visible) {\n      return (\n        <div className='media-gallery'>\n          { render_sensitiveInfo } { render_attachement }\n        </div>\n      );\n    } else {\n      return (\n        <div className='media-gallery'>\n          { render_mediaSpoiler }\n        </div>\n      );\n    }\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./app/javascript/mastodon/components/media_gallery.js"],"sourceRoot":""}